\documentclass{amsart}

\usepackage[T1]{fontenc}
\usepackage{enumerate, amsmath, amsfonts, amssymb, amsthm, mathrsfs, wasysym, graphics, graphicx, xcolor, url, hyperref, hypcap, shuffle, xargs, multicol, overpic, pdflscape, multirow, hvfloat, minibox, accents, array, multido, xifthen, a4wide, ae, aecompl, blkarray, pifont, mathtools, etoolbox, dsfont, verbatim, stackrel}
\usepackage{marginnote}
\hypersetup{colorlinks=true, citecolor=darkblue, linkcolor=darkblue}
\usepackage[all]{xy}
\usepackage[bottom]{footmisc}
\usepackage{tikz}
%\usepackage{tkz-graph}
%\usepackage{tikz-qtree}
\usetikzlibrary{trees, decorations, decorations.markings, shapes, arrows, matrix, calc, fit, intersections, patterns, angles, cd}
\usepackage[external]{forest}
%\tikzexternalize
\graphicspath{{figures/}{figures/nodes/}}
\makeatletter\def\input@path{{figures/}}\makeatother
\usepackage{caption}
\captionsetup{width=\textwidth}
\renewcommand{\topfraction}{1} % possibility to have one page of pictures
\renewcommand{\bottomfraction}{1} % possibility to have one page of pictures
\usepackage[noabbrev,capitalise]{cleveref}
\usepackage[export]{adjustbox}
\usepackage{ulem}\normalem

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% theorems
\newtheorem{theorem}{Theorem}%[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem*{theorem*}{Theorem}%[section]

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{question}[theorem]{Question}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{assumption}[theorem]{Assumption}
\crefname{notation}{Notation}{Notations}
\crefname{problem}{Problem}{Problems}

% math special letters
\newcommand{\R}{\mathbb{R}} % reals
\newcommand{\N}{\mathbb{N}} % naturals
\newcommand{\Z}{\mathbb{Z}} % integers
\newcommand{\C}{\mathbb{C}} % complex
\newcommand{\I}{\mathbb{I}} % set of integers
\newcommand{\HH}{\mathbb{H}} % hyperplane
\newcommand{\K}{\mathbb{K}} % field
\newcommand{\fA}{\mathfrak{A}} % alternating group
\newcommand{\fB}{\mathfrak{S}^\textsc{b}} % signed symmetric group
\newcommand{\cA}{\mathcal{A}} % algebra
\newcommand{\cC}{\mathcal{C}} % collection
\newcommand{\cS}{\mathcal{S}} % ground set
\newcommand{\uR}{\underline{R}} % underline set
\newcommand{\uS}{\underline{S}} % underline set
\newcommand{\uT}{\underline{T}} % underline set
\newcommand{\oS}{\overline{S}} % overline set
\newcommand{\ucS}{\underline{\cS}} % underline ground set
\renewcommand{\c}[1]{\mathcal{#1}} % caligraphic letters
\renewcommand{\b}[1]{{\boldsymbol{#1}}} % bold letters
\newcommand{\bb}[1]{\mathbb{#1}} % bb letters
\newcommand{\f}[1]{\mathfrak{#1}} % frak letters
\newcommand{\h}{\widehat} % hat letters

% hello

% math commands
\newcommand{\set}[2]{\left\{ #1 \;\middle|\; #2 \right\}} % set notation
\newcommand{\bigset}[2]{\big\{ #1 \;\big|\; #2 \big\}} % big set notation
\newcommand{\Bigset}[2]{\Big\{ #1 \;\Big|\; #2 \Big\}} % Big set notation
\newcommand{\setangle}[2]{\left\langle #1 \;\middle|\; #2 \right\rangle} % set notation
\newcommand{\ssm}{\smallsetminus} % small set minus
\newcommand{\dotprod}[2]{\left\langle \, #1 \; \middle| \; #2 \, \right\rangle} % dot product
\newcommand{\symdif}{\,\triangle\,} % symmetric difference
\newcommand{\one}{\b{1}} % the all one vector
\newcommand{\eqdef}{\mbox{\,\raisebox{0.2ex}{\scriptsize\ensuremath{\mathrm:}}\ensuremath{=}\,}} % :=
\newcommand{\defeq}{\mbox{~\ensuremath{=}\raisebox{0.2ex}{\scriptsize\ensuremath{\mathrm:}} }} % =:
\newcommand{\simplex}{\b{\triangle}} % simplex
\renewcommand{\implies}{\Rightarrow} % imply sign
\newcommand{\transpose}[1]{{#1}^t} % transpose matrix

% operators
\DeclareMathOperator{\conv}{conv} % convex hull
\DeclareMathOperator{\vect}{vect} % linear span
\DeclareMathOperator{\cone}{cone} % cone hull
\DeclareMathOperator{\inv}{inv} % inversions
\DeclareMathOperator{\ninv}{ninv} % inversions
\DeclareMathOperator{\Ima}{Im} % image
\DeclareMathOperator{\Vol}{Vol} % (mixed) volume

% others
\newcommand{\ie}{\textit{i.e.}~} % id est
\newcommand{\eg}{\textit{e.g.}~} % exempli gratia
\newcommand{\Eg}{\textit{E.g.}~} % exempli gratia
\newcommand{\apriori}{\textit{a priori}} % a priori
\newcommand{\viceversa}{\textit{vice versa}} % vice versa
\newcommand{\versus}{\textit{vs.}~} % versus
\newcommand{\aka}{\textit{a.k.a.}~} % also known as
\newcommand{\perse}{\textit{per se}} % per se
\newcommand{\ordinal}{\textsuperscript{th}} % th for ordinals
\newcommand{\ordinalst}{\textsuperscript{st}} % st for ordinals
\definecolor{darkblue}{rgb}{0,0,0.7} % darkblue color
\definecolor{green}{RGB}{57,181,74} % darkblue color
\definecolor{violet}{RGB}{147,39,143} % darkblue color
\newcommand{\darkblue}{\color{darkblue}} % darkblue command
\newcommand{\defn}[1]{\textsl{\darkblue #1}} % emphasis of a definition
\newcommand{\para}[1]{\smallskip\noindent\uline{#1.}} % paragraph
\renewcommand{\topfraction}{1} % possibility to have one page of pictures
\renewcommand{\bottomfraction}{1} % possibility to have one page of pictures
%\renewcommand\labelitemi{$\diamond$} % redefine itemize default symbol

% marginal comments
\usepackage{todonotes}
\newcommand{\vincent}[1]{\todo[color=blue!30]{\rm #1 \\ \hfill --- V.}}
\newcommand{\Vincent}[1]{\todo[inline, color=blue!30]{\rm #1 \\ \hfill --- V.}}
\newcommand{\jean}[2][]{\todo[size=\scriptsize, color=orange!30,#1]{\rm #2 \\ \hfill --- J.}}
\newcommand{\Jean}[2][]{\todo[inline, size=\scriptsize, color=orange!30,#1]{\rm #2 \\ \hfill --- J.}}

% lattices
\newcommand{\meet}{\wedge} % meet
\newcommand{\join}{\vee} % join
\newcommand{\bigMeet}{\bigwedge} % meet
\newcommand{\bigJoin}{\bigvee} % join
\newcommandx{\projDown}[1][1={}]{\smash{\pi_\downarrow^{#1}}} % down projection map
\newcommandx{\projUp}[1][1={}]{\smash{\pi^\uparrow_{#1}}} % up projection map
\newcommand{\con}{\mathrm{con}} % congruence

% geometry
\newcommandx{\Fan}[1][1=D]{\mathcal{F}_{#1}} % fan
\newcommand{\polytope}[1]{\mathds{#1}} % font polytope

% polytopes
\newcommand{\Asso}{\polytope{A}\mathsf{sso}} % associahedron
% rectangulotopes
\newcommand{\WRP}{\polytope{WR}} % weak rectangulotope
\newcommand{\SRP}{\polytope{SR}} % strong rectangulotope
% shard polytopes
\newcommand{\SP}{\polytope{SP}}

% horizontal pattern
\newcommand{\horizontalPattern}{\smash{\raisebox{-.15cm}{\includegraphics[scale=.5]{horizontalPattern}}}} 
% vertical pattern
\newcommand{\verticalPattern}{\smash{\raisebox{-.25cm}{\includegraphics[scale=.5]{verticalPattern}}}} 

% Loday and anti-Loday accents (?)
\newcommand{\loday}[1]{\overset{\frown}{#1}}
\newcommand{\antiloday}[1]{\overset{\smile}{#1}}
% yin and yang accents (?)
\newcommand{\yang}[1]{\overset{\backsim}{#1}}
\newcommand{\yin}[1]{\overset{\sim}{#1}}
% weak (Baxter) and strong equivalence on S_n
\newcommand{\baxtereq}{\asymp}%{\stackrel{\frown}{\smile}}
\newcommand{\strongeq}{\simeq}% % J: I would like to stack \backsim and \sim instead

% formating the table of contents
\setcounter{tocdepth}{4}
\makeatletter
\def\l@part{\@tocline{1}{8pt}{0pc}{}{}}
\def\l@section{\@tocline{1}{4pt}{0pc}{}{}}
\makeatother
\let\oldtocpart=\tocpart
\renewcommand{\tocpart}[2]{\sc\large\oldtocpart{#1}{#2}}
\let\oldtocsection=\tocsection
\renewcommand{\tocsection}[2]{\bf\oldtocsection{#1}{#2}}
\let\oldtocsubsubsection=\tocsubsubsection
\renewcommand{\tocsubsubsection}[2]{\quad\oldtocsubsubsection{#1}{#2}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\title{Rectangulation polytopes}
\title{Rectangulotopes}

\thanks{VP was partially supported by the Spanish grant PID2022-137283NB-C21 of MCIN/AEI/10.13039/501100011033 / FEDER, UE, by Departament de Recerca i Universitats de la Generalitat de Catalunya (2021 SGR 00697), by the French grant CHARMS (ANR-19-CE40-0017), and by the French--Austrian projects PAGCAP (ANR-21-CE48-0020 \& FWF I 5788).}

\author{Jean Cardinal}
\address{Universit√© libre de Bruxelles (ULB)}
\email{jean.cardinal@ulb.be}
\urladdr{\url{https://jean.cardinal.web.ulb.be}}

\author{Vincent Pilaud}
\address{Universitat de Barcelona}
\email{vincent.pilaud@ub.edu}
\urladdr{\url{https://www.ub.edu/comb/vincentpilaud/}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{abstract}
  Rectangulations are decompositions of a square into finitely many axis-aligned rectangles.
  We describe realizations of $(n-1)$-dimensional polytopes associated with rectangulations composed of $n$ rectangles. They are defined as quotientopes of natural congruence relations on the weak Bruhat order on permutations in $\f{S}_n$, and their skeleta are flip graphs on rectangulations. We give elementary formulas for computing the coordinates of each vertex of the polytope, in the spirit of Loday's realization of the associahedron.
\end{abstract}

\maketitle

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\section{Introduction}

\subsection{Polytopes of permutations, triangulations, and rectangulations}

The encoding of combinatorial objects in the form of a polyhedral structure is a recurrent theme in geometric and algebraic combinatorics, matroid and polymatroid theory, and combinatorial optimization.

An elementary yet striking example of this idea is the \defn{permutahedron} $\polytope{P} (n)$, defined as the convex hull of the points $\sum_{i\in [n]} \pi^{-1}(i)\cdot \mathbf{e}_i$, for all permutations $\pi\in\f{S}_n$. The facets of $\polytope{P} (n)$ are indexed by the nonempty and nontrivial subsets of $[n]$, while its skeleton is the Cayley graph of the symmetric group for the generators consisting of adjacent transpositions. 

The \defn{associahedron} is an ubiquitous polytope, first defined by Tamari~\cite{T51}, then studied by Stasheff in a topological context~\cite{S63}, that has since then found applications in various areas of mathematics, including topology~\cite{}, operads~\cite{}, cluster algebras~\cite{}, combinatorial Hopf algebras~\cite{}, physics~\cite{}, etc. It was first defined as a combinatorial object, before geometric realizations were shown to exist~\cite{}.

The face lattice of the $(n-1)$-dimensional associahedron is the reverse inclusion poset of nonintersecting diagonals of a convex $(n+3)$-gon. In particular, it skeleton is the \defn{flip graph} on \defn{triangulations} of the $(n+3)$-gon, or equivalently -- via a standard Catalan bijection -- the \defn{rotation graph} on \defn{binary trees} with $n$ internal nodes, whose structure has been the subject of many investigations, with applications in computer science~\cite{}.

In 2004, Loday published the following elegant realization of the associahedron~\cite{}.

\begin{theorem}
  \label{thm:loday}
  Let $\Asso (n)$ be the convex hull of the points
  $\sum_{i\in [n]} w_i\cdot \mathbf{e}_i$, where
  \[
  w_i := \ell(T, i)\cdot r(T,i),
  \]
  for all binary trees $T$ on $n$ internal nodes, where $\ell(T,i)$ and $r(T,i)$ denote respectively the number of leaves in the left and right subtrees of $i$ in $T$.
  Then $\Asso (n)$ is a realization of the $(n-1)$-dimensional associahedron.
\end{theorem}

A natural object associated with the associahedron is the \defn{Tamari lattice}, a lattice whose cover graph is isomorphic to the skeleton of the associahedron. The Tamari lattice is known to be the quotient of the weak Bruhat order by a \defn{lattice congruence} relation called the \defn{sylvester congruence}. Pilaud and Santos~\cite{}, answering a question of Reading~\cite{}, proved that with \emph{every} lattice congruence of the weak order, one can associate a polytope whose skeleton is the cover graph of the lattice quotient, and more generally whose normal fan is the fan defined by gluing the cones of the \defn{braid fan} (the type $A$ Coxeter arrangement) that belong to the same congruence class. They called such polytopes \defn{quotientopes}.

The goal of this paper is to initiate the study of quotientopes of lattice congruences whose classes are in bijections with \defn{rectangulations}, defined as decompositions of a square into finitely many axis-aligned rectangles.

Those lattice congruences are the \defn{Baxter congruence} on one hand, studied by Law and Reading~\cite{}, and whose classes are one-to-one with \defn{weak rectangulations} (or \defn{diagonal rectangulations}), and the \defn{strong rectangulation congruence}, whose classes are in bijection with so-called \defn{strong rectangulations}. The latter is mentioned by Reading~\cite{} (seee for instance in Theorem 1.2, and Example 4.11), and studied more recently by Asinowski et al.~\cite{}.

One of our main results is an elementary description of the vertex coordinates of a realization of both families of quotientopes, in the spirit of Theorem~\ref{thm:loday}.
The quotientopes corresponding to the Baxter congruence will be referred to as the \defn{weak rectangulotopes} and denoted by $\WRP(n)$. similarly, the polytopes corresponding to the strong rectangulation congruence will be called the \defn{strong rectangulotopes} and denoted by $\SRP(n)$.

In this introduction, we give a minimal set of definition to be able to completely state our results on the vertex description of the weak and strong rectangulotopes. Section~\ref{sec:quotientopes} is dedicated to the background on quotientopes and their realizations as Minkowski sums of \defn{shard polytopes}, due to Padrol, Pilaud, and Ritter~\cite{}. Section~\ref{sec:wr} details the case of weak rectangulations, while Section~\ref{sec:sr} deals with strong rectangulations.

\subsection{Weak and strong rectangulations}

\begin{itemize}
\item Terminology: rectangles, \defn{vertices}, \defn{segments}, \defn{generic} rectangulation
\item \defn{Wall slides}
\item Two equivalence classes: \defn{weak equivalence} preserving rectangle-segment adjacencies, and \defn{strong equivalence} preserving rectangle-rectangle adjacencies.
\item Weak equivalence classes have a \defn{diagonal} representative.
\item \defn{Flip graphs} on rectangulations
\end{itemize}

Law and Reading~\cite{} defined a flip graph on weak rectangulations.

\begin{lemma}
  The skeleton of $\WRP(n)$ is isomorphic to the flip graph of weak rectangulations of size $n$.
\end{lemma}

Meehan~\cite{} (See also Asinowski et al.~\cite{}) describe the flip graph on strong rectangulations.

\begin{lemma}
  The skeleton of $\SRP(n)$ is isomorphic to the flip graph of strong rectangulations of size $n$.
\end{lemma}


\subsection{Source and target trees of a rectangulation}
\label{subsec:sourceTargetTrees}

\jean{Here only give the definitions allowing to state the results.}

\begin{figure}
	\centerline{\includegraphics[scale=.7]{strongRectangulation} \qquad \includegraphics[scale=.7]{strongRectangulationTrees}}
	\caption{\label{fig:sourceTargetTrees}A strong rectangulation (left) and its pair of intertwining binary trees (right). Example from \cite{AsinowskiCardinalFelsnerFusy}.}
        % The corresponding $2$-clumped permutation is $[7,5,14,8,1,6,15,11,4,10,16,2,9,13,3,12]$ and its inverse is $[5, 12, 15, 9, 2, 6, 1, 4, 13, 10, 8, 16, 14, 3, 7, 11]$.
\end{figure}

Fix a rectangulation~$R$ with $n$ rectangles, and consider the directed graph~$D(R)$ whose vertex set is the set of all vertices of~$R$, and whose edges are obtained as follows.
For each rectangle~$r$ of~$R$, we include in~$D(R)$ four edges joining the vertices of~$r$, where the horizontal edges are oriented from left to right, and the vertical edges are oriented from bottom to top.
Hence, the bottom left corner of~$r$ is its source~$s(r)$, while its top right corner is its target~$t(r)$.
Note that since~$R$ is generic, the sources~$\set{s(r)}{r \in [n]}$ and the targets~$\set{t(r)}{r \in [n]}$ are disjoint.
The \defn{source tree}~$S(R)$ (resp.~\defn{target tree}~$T(R)$) is the subgraph of~$D(R)$ induced by the sources~$\set{s(r)}{r \in [n]}$ (resp.~by the targets~$\set{t(r)}{r \in [n]}$).
See \cref{fig:sourceTargetTrees}.

\begin{lemma}
The source tree~$S(R)$ (resp.~target tree~$T(R)$) is a binary tree, rooted at the bottom left (resp.~top right) corner of~$R$, and oriented from (resp.~towards) its root.
\end{lemma}

\begin{comment}
\begin{proof}
By symmetry, we only prove the statement for the source tree~$S(R)$.
As the rectangulation is generic, each source~$s(r)$ distinct from the bottom left corner of~$R$ is either on the top edge of a rectangle~$r'$ or on the right edge of a rectangle~$r'$ (but not both).
This shows that~$r$ distinct from the bottom left rectangle of~$R$ has a unique parent~$r'$ in~$S(R)$, so that~$S(R)$ is indeed a tree on~$[n]$.
This tree is binary as each node has at most one vertical child and one horizontal child, and no other children.
\end{proof}
\end{comment}

We complete each node of~$S(R)$ and~$T(R)$ with a vertical (resp.~horizontal) leaf if it has no vertical (resp.~horizontal) child, see \cref{fig:sourceTargetTrees}.
Recall that the \defn{inorder labeling} of a binary tree~$T$ is the labeling of the nodes of~$T$ such that the label of each node~$t$ of~$T$ is larger than all labels in the left subtree of~$t$ and larger than all labels in the right subtree of~$t$.

\begin{lemma}
For any rectangle~$r$ of~$R$, the inorder label of the source~$s(r)$ in~$S(R)$ coincides with the inorder label of the target~$t(r)$ in~$T(R)$.
\end{lemma}

This enables to unambiguously label the rectangles of~$R$ by the inorder 
The resulting labeling coincides with the NW--SE labeling of~\cite{AsinowskiCardinalFelsnerFusy}.
From now on, the labels of the rectangles in a rectangulations are the inorder labels, and the two trees $T(R)$ and $S(R)$ are defined on the vertex set $[n]$ accordingly.
For each $i\in [n]$, we refer to its two subtrees in $T(R)$ as the \defn{horizontal} and \defn{vertical subtrees}, and similarly for $S(R)$. 

\subsection{Weak rectangulotopes}

We are now ready to give our first main result on the realizations of weak rectangulotopes.

\begin{theorem}
  Let $\WRP (n)$ be the convex hull of the points
  $\sum_{i\in [n]} (\loday{w}_i - \antiloday{w}_i)\cdot \mathbf{e}_i$,
  where
  \[
  \begin{split}
    \loday{w}_i := & h(T, i)\cdot v(T,i) \\
    \antiloday{w}_i := & h(S, i)\cdot v(S,i),
  \end{split}
  \]
  for all weak rectangulations $R$ on $n$ rectangles, where $T:=T(R)$, $S:=S(R)$,
  and $h(T,i)$ and $v(T,i)$ denote respectively the number of leaves in the horizontal and vertical subtrees of $i$ in the tree $T$.
  Then $\WRP (n)$ is a realization of the $(n-1)$-dimensional weak rectangulotope.
\end{theorem}

\subsection{Strong rectangulotopes}

Two leaves of the trees $T(R)$ and $S(R)$ are said to be \defn{common leaves} if the edges to their parents lie on the same segment of $R$. We denote by %$i|j$ and $\frac{\ j\ }i$
$i\backslash j$ the situation where the rectangle labeled $i$ touches the rectangle labeled $j$ either from the left or from below in $R$. %, respectively.

\begin{theorem}
  Let $\SRP (n)$ be the convex hull of the points
  \[
  \sum_{i,j\in [n], i< j} (\yin{w}_{i,j} - \yang{w}_{i,j})\cdot (\mathbf{e}_i - \mathbf{e}_j),
  \]
  with
  \[
  \begin{split}
    \yin{w}_{i,j} := & h(T, i) \cdot cv (T, S, i, j)\cdot h(S, j)\cdot [ \neg i\backslash j ] \\ % \neg i|j \text{ and } \neg \frac{\ j\ }i ] \\
    \yang{w}_{i,j} := & v(S, j) \cdot ch (T, S, i, j)\cdot v(T, i) \cdot [ \neg j\backslash i ]
  \end{split}
  \]
  
%  \begin{cases}
%    h(T(R), i) \cdot cv (T, S, i, j)\cdot h(S, j) & \text{ if neither } i|j \text{ nor } \frac{\ j\ }i, \\
%    0 & \text{ otherwise.}
%  \end{cases}

  %\begin{cases}
  %  v(S, j) \cdot ch (T, S, i, j)\cdot v(T, i) & \text{ if neither } j|i \text{ nor } \frac{\ i\ }j, \\
  %  0 & \text{ otherwise.}
  %\end{cases}

  \jean{Double check the formula.}
  for all strong rectangulations $R$ on $n$ rectangles, where:
  \begin{itemize}
  \item $T := T(R)$ and $S:=S(R)$,
  \item $h(T,i)$ and $v(T,i)$ denote respectively the number of leaves in the horizontal and vertical subtrees of $i$ in the tree $T$,
  \item $ch (T,S,i,j)$ and $cv (T,S,i,j)$ denote respectively the number of common leaves of the horizontal (vertical) subtree of $i$ in $T$ and the horizontal (vertical) subtree of $j$ in $S$
  \end{itemize}
Then $\SRP (n)$ is a realization of the $(n-1)$-dimensional strong rectangulotope.  
\end{theorem}

\Jean{Is there a more concise way to write this down/compute? Here we do not take advantage of the fact that at most one of the two factors $\yin{w}_{i,j}$ and $\yang{w}_{i,j}$ is nonzero.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Quotientopes}
\label{sec:quotientopes}

\subsection{Quotients of the weak Bruhat order on permutations}

\subsection{Arc diagrams}

\begin{theorem}
  Congruences on the weak Bruhat order are one-to-one with arc ideals.
\end{theorem}

\subsection{Shard polytopes}

\begin{theorem}
  The quotientope of a congruence $\equiv$ on the weak Bruhat order is realized by the Minkowski sum of the shard polytopes corresponding to the arcs in the arc ideal defining $\equiv$.
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Weak rectangulotopes}
\label{sec:wr}

%%%%%%%%%%%%
\subsection{The Baxter congruence}

\jean{Clash of terminology: weak vs. Baxter?}

Given a rectangulation $R$, the two trees $T(R)$ and $S(R)$, where the horizontal edges are oriented from left to right and the vertical edges are oriented from bottom to top,
define two partial orders on $[n]$.
We define the \defn{weak poset} $P_w(R)=([n],\prec_w)$ of a rectangulation $R$ as the transitive closure of the union of the two partial orders defined by the intertwining binary trees $T(R)$ and $S(R)$. The weak poset is a two-dimensional lattice, whose minimum is the root of $S(R)$ and the maximum is the root of $T(R)$.

\begin{theorem}
  The subsets $\mathcal{L}(P_w(R))$ of $\f{S}_n$, for all rectangulations $R$ on $n$ rectangles, 
  are equivalence classes of a congruence relation $\baxtereq$ on the weak Bruhat order on $\f{S}_n$.
  Furthermore:
  \begin{itemize}
  \item The congruence classes are one-to-one with weak rectangulations,  
  \item the minimal elements of each congruence class are the twisted Baxter permutations,
  \item the maximal elements are the co-twisted Baxter permutations,
  \item the congruence classes each contain a single Baxter permutation, and are one-to-one with Baxter permutations.
  \end{itemize}
\end{theorem}

\begin{figure}
	\centerline{\includegraphics[scale=.7]{weakRectangulation} \qquad \includegraphics[scale=.7]{weakRectangulationTrees}}
	\caption{A diagonal rectangulation (left) and its pair of separated twin trees (right). The corresponding twisted Baxter permutation is $[7, 5, 1, 14, 8, 6, 4, 2, 11, 10, 9, 3, 15, 16, 13, 12]$ and its inverse is $[3, 8, 12, 7, 2, 6, 1, 5, 11, 10, 9, 16, 15, 4, 13, 14]$.}
\end{figure}

We call this congruence the \defn{Baxter congruence}.
The \defn{weak rectangulotope} $\WRP(n)$ is the quotientope of the Baxter congruence $\baxtereq$ on the weak Bruhat order on $\f{S}_n$.

\subsection{Loday and anti-Loday arcs}

\begin{lemma}
The Baxter congruence $\baxtereq$ on $\f{S}_n$ is defined by the arc ideal composed of arcs that do not cross the horizontal line.
\end{lemma}

Therefore, the quotientope is realized by a Minkowski sum of the shard polytopes defined by two families of arcs: the \defn{Loday arcs} and the \defn{anti-Loday arcs}, that go respectively above and below all elements of an interval $I$ of $[n]$.

\begin{lemma}
  \label{lem:lodaysp}
  Given a Loday arc $A$ defined by an interval $I$, the Loday shard polytope $\SP(A)$ is a translate of the standard simplex $\conv \{ \mathbf{e}_i : i\in I \}$.
\end{lemma}

\begin{lemma}
  \label{lem:antilodaysp}
  Given an anti-Loday arc $A$ defined by an interval $I$, the anti-Loday shard polytope $\SP(A)$ is a translate of the negative standard simplex $\conv \{ - \mathbf{e}_i : i\in I \}$.
\end{lemma}

\begin{lemma}
  The weak rectangulotope $\WRP(n)$ is realized by the Minkowski sum of all Loday and anti-Loday shard polytopes. In particular, it is the Minkowski sum of two opposite Loday associahedra.
\end{lemma}

\subsection{Loday-type coordinates for weak rectangulotopes}

For every rectangulation $R$, we wish to give the coordinates of a point $p(R)\in\R^n$ such that $\WRP(n)$ is the convex hull of the points $p(R)$ for all rectangulations $R$.
Recall that in a Minkowski sum of polytopes, the vertex that is extremal in a generic direction is the sum of the vertices of the summands that are extremal in this direction.
We therefore need to understand which vertices of the translates of the shard polytopes defined in Lemmas~\ref{lem:lodaysp} and~\ref{lem:antilodaysp} are extremal for a direction given by a permutation.

\begin{lemma}
  \label{lem:lodaymax}
  Let $\pi\in\f{S}_n$ and consider a Loday arc $A$ defined by an interval $I$.
  The unique vertex of $\SP(A)$ that is extreme with respect to the direction $\pi^{-1}$
  is $\mathbf{e}_i$, where $i := \arg\max_{j\in I} \pi^{-1}(j)$.
  Similarly, if $A$ is an anti-Loday arc defined by $I$, the unique vertex of $\SP(A)$ that is extreme with respect to the direction $\pi^{-1}$
  is $-\mathbf{e}_i$, where $i := \arg\min_{j\in I} \pi^{-1}(j)$.
\end{lemma}

Note that this extremal vertex should only depend on the Baxter congruence class of $\pi$.
This, in passing, gives us an alternative characterization of the Baxter congruence:
$\pi\baxtereq\sigma$ if and only if for any interval $I$ of $[n]$, $\arg\max_{j\in I} \pi^{-1}(j)=\arg\max_{j\in I} \sigma^{-1}(j)$, and
$\arg\min_{j\in I} \pi^{-1}(j)=\arg\min_{j\in I} \sigma^{-1}(j)$.

\begin{lemma}
  Let $R$ be a rectangulation on $n$ rectangles and $p(R)$ the vertex of $\WRP(n)$ associated with $R$.
  Given $i\in [n]$, the number of Loday arcs $A$ such that $\mathbf{e}_i$ is the extremal vertex of $\SP(A)$ contributing to $p(R)$ is
  \[
  \loday{w}_i =  h(T(R), i)\cdot v(T(R),i),
  \]
   where $h(T,i)$ and $v(T,i)$ denote respectively the number of leaves in the horizontal and vertical subtrees of $i$ in the tree $T$.
\end{lemma}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Strong rectangulotopes}
\label{sec:sr}

%%%%%%%%%%%%
\subsection{The strong rectangulation congruence}

We define the \defn{strong poset} $P_s(R)=([n],\prec_s)$ of a rectangulation $R$.
For a poset $P$ on $[n]$, we define $\mathcal{L}(P)$ as the set of permutations of $\f{S}_n$ corresponding to linear extensions of $P$.

\begin{theorem}
  The subsets $\mathcal{L}(P_s(R))$ of $\f{S}_n$, for all rectangulations $R$ on $n$ rectangles, 
  are equivalence classes of a congruence relation $\strongeq$ on the weak Bruhat order on $\f{S}_n$.
    Furthermore:
  \begin{itemize}
  \item The congruence classes are one-to-one with strong rectangulations,  
  \item the minimal elements of each congruence class are the 2-clumped permutations,
  \item the maximal elements are the co-2-clumped permutations.
  \end{itemize}
\end{theorem}

We call the congruence $\strongeq$ the \defn{strong rectangulation congruence}.
The \defn{strong rectangulotope} $\SRP(n)$ is the quotientope of the strong rectangulation congruence $\strongeq$.

\jean{Does the congruence have a name?}

\subsection{Yin and yang arcs}

\begin{lemma}
  The strong rectangulation congruence $\strongeq$ on $\f{S}_n$ is defined by the arc ideal composed of arcs that cross the horizontal line at most once.
\end{lemma}

We classify the arcs into two families, depending on whether the arcs cross from above or below.
A \defn{yin arc} is defined by two consecutive nonempty intervals $I$ and $J$ of $[n]$ such that the arc goes above all elements of $I$ and below all elements of $J$.
A \defn{yang arc} is defined similarly, except that the arc goes below the elements of $I$ and above the elements of $J$. 

\begin{lemma}
  \label{lem:yinsp}
  Given a yin arc $A=(I,J)$, the yin shard polytope $\SP(A)$ is defined as the convex hull of the points
  $\{\mathbf{0} \}\cup \{ \mathbf{e}_i - \mathbf{e}_j : (i,j)\in I\times J\}$.
\end{lemma}

\begin{lemma}
  \label{lem:yangsp}
  Given a yang arc $A=(I,J)$, the yang shard polytope $\SP(A)$ is a translate of the convex hull of the points
  $\{\mathbf{0} \}\cup \{ \mathbf{e}_j - \mathbf{e}_i : (i,j)\in I\times J\}$.
\end{lemma}

Note that yin shard polytopes are translates of the Loday shard polytopes when $|J|=1$, and of the anti-Loday shard polytopes when $|I|=1$.
similarly, Loday and anti-Loday shard polytopes are translates of some yang shard polytopes.

The following is a direct application of the main result of Padrol, Pilaud, and Ritter~\cite{}.

\begin{lemma}
  \label{lem:strongsum}
  The strong rectangulotope $\SRP(n)$ is realized by the Minkowski sum of all shard polytopes of yin and yang arcs.
\end{lemma}

Since the combinatorial type of a Minkowski sum is invariant to translation of the summands, we can use the polytopes defined in Lemmas~\ref{lem:yinsp} and~\ref{lem:yangsp} as a definition of the yin and yang shard polytopes.
Also note that since Loday and anti-Loday shard polytopes are, up to a translation, both yin and yang, each Loday and anti-Loday shard polytope is summed twice in the proposed realization.
This, again, does not change the combinatorial type of the polytope.

Lemma~\ref{lem:strongsum} gives us an alternative description of $\SRP(n)$ as the sum of two opposite quotientopes defined by the \defn{yin} and \defn{yang congruences} respectively, where the yin congruence is defined by the arc ideal consisting of all yin arcs, and the yang congruence is defined by the yang arcs.

\subsection{Loday-type coordinates for strong rectangulotopes}

For every rectangulation $R$, we wish to give the coordinates of a point $p(R)\in\R^n$ such that $\SRP(n)$ is the convex hull of the points $p(R)$ for all rectangulations $R$.
We first consider the contributions, to these coordinates, of the Minkowski summand $\SP(A)$ for all yin arcs $A$.
Recall that in a Minkowski sum of polytopes, the vertex that is extremal in a generic direction is the sum of the vertices of the summands that are extremal in this direction.
We therefore need to understand which vertices of the translates of the yin shard polytopes defined in Lemmas~\ref{lem:yinsp} are extremal for a direction given by a permutation.

\begin{lemma}
  \label{lem:yinminmax}
  Let $\pi\in\f{S}_n$ and consider a yin arc $A=(I,J)$.
  Let $i := \arg\max_{k\in I} \pi^{-1}(k)$ and $j := \arg\min_{k\in J} \pi^{-1}(k)$.
  The unique vertex of $\SP(A)$ that is extreme with respect to the direction $\pi^{-1}$
  is $\mathbf{e}_i-\mathbf{e}_j$ if $\pi^{-1}(i)>\pi^{-1}(j)$, and $\mathbf{0}$ otherwise.
\end{lemma}

Note again that by definition, this extremal vertex should only depend on the strong congruence class of $\pi$.

\begin{lemma}
  Let $R$ be a rectangulation on $n$ rectangles and $p(R)$ the vertex of $\SRP(n)$ associated with $R$.
  Given a pair $i,j\in [n]$ with $i<j$, the number of yin arcs $A$ such that $\mathbf{e}_i-\mathbf{e}_j$
  is the extremal vertex of $\SP(A)$ contributing to $p(R)$ is
  \[
    h(T(R), i) \cdot cv (T(R), S(R), i, j)\cdot h(S(R), j) 
  \]
  if neither $i|j$ nor $\frac{\ j\ }i$, and $0$ otherwise.
\end{lemma}
\begin{proof}
  Let $\pi$ be the 2-clumped permutation corresponding to $R$, hence the minimal element of $\mathcal{L}(P_s(R))$ in the weak Bruhat order.
  From Lemma~\ref{lem:yinminmax}, the set of yin arcs $A$ such that $\SP(A)$ contributes to $\mathbf{e}_i-\mathbf{e}_j$
  are defined by pairs of contiguous intervals $I,J$ of $[n]$ with $i\in I$, $j\in J$, such that:
  \begin{itemize}
  \item $i = \arg\max_{k\in I} \pi^{-1}(k)$,
  \item $j = \arg\min_{k\in J} \pi^{-1}(k)$, and
  \item $i,j$ is an inversion in $\pi$, hence $\pi^{-1}(i)>\pi^{-1}(j)$.
  \end{itemize}
  We observe that provided the third condition holds, the number of choices of the three endpoints defining such a pair of intervals $I$ and $J$ is the product of the
  number of leaves of the subtree of $T(R)$ rooted at $i$, the number of common leaves to the vertical subtrees of $T(R)$ and $S(R)$ rooted
  at $i$ and $j$, respectively, and the number of leaves of the subtree of $S(R)$ rooted at $j$.
  
  It remains to observe that the only case where this product is nonzero and $i,j$ is not an inversion in $\pi$ is when either $i|j$ or $\frac{\ j\ }i$.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\clearpage
\addtocontents{toc}{ \vspace{.1cm} }
\bibliographystyle{alpha}
\bibliography{rectangulotopes}
\label{sec:biblio}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%
\newpage
\appendix
\section{Material}

Properties/results we may need along the way.

\subsection{Twin binary trees.}

\begin{lemma}
The source tree~$S(R)$ and target tree~$T(R)$ are \defn{twin binary trees}, meaning that they satisfy the following equivalent conditions:
\begin{enumerate}[(i)]
\item $S$ and~$T$ admit a common linear extension,
\item for any~$i \in [n-1]$, the node~$i$ is in the left subtree of the node~$i+1$ in~$S$ if and only if the node~$i+1$ is in the right subtree of the node~$i$ in~$R$,
\item for any~$i \in [n-1]$, the $(i+1)$th leaf of~$S$ is a left leaf if and only if the $(i+1)$th leaf of~$R$ is a right leaf.
\end{enumerate}
\end{lemma}

\subsection{Properties of diagonal rectangulations.}

We call \defn{diagonal} the segment joining the top left corner to the bottom right corner.
A rectangulation~$R$ is \defn{diagonal} if it satisfies the following equivalent conditions:
\begin{enumerate}[(i)]
\item all rectangles of~$R$ meet the diagonal,
\item the source~$s(r)$ (resp.~target~$t(r)$) of each rectangle~$r$ of~$R$ is below (resp.~above) the diagonal,
\item the source tree~$S(R)$ (resp.~target tree~$T(R)$) remains below (resp.~above) the diagonal,
\item the source tree~$S(R)$ and the target tree~$T(R)$ do not overlap along a segment of~$R$,
\item $R$ avoids the patterns \horizontalPattern{} and \verticalPattern{},
\item the $2$-clumped permutation~$\projDown(R)$ avoids the patterns~$2413$ and~$3412$,
\item the co-$2$-clumped permutation~$\projDown(R)$ avoids the patterns~$2143$ and~$3142$,
\end{enumerate}


\begin{proposition}
The weak rectangulation insertion of any permutation~$\sigma$ of~$[n]$ is given by the rectangles~$[w\ell(i, \sigma), wr(i, \sigma)-1] \times [n-wd(i, \sigma)+1, n-wu(i, \sigma)]$ for~$i \in [n]$ where
\begin{align*}
w\ell(i, \sigma) & \eqdef \max \; \{0\} \cup \set{j}{j < i \text{ and } \sigma^{-1}(j) < \sigma^{-1}(i)} \\
wr(i, \sigma) & \eqdef \min \; \{n+1\} \cup \set{j}{i < j \text{ and } \sigma^{-1}(i) < \sigma^{-1}(j)} \\
wd(i, \sigma) & \eqdef \min \; \{n+1\} \cup \set{j}{i < j \text{ and } \sigma^{-1}(j) < \sigma^{-1}(i)} \\
\text{and} \qquad
wu(i, \sigma) & \eqdef \max \; \{0\} \cup \set{j}{j < i \text{ and } \sigma^{-1}(i) < \sigma^{-1}(j)}.
\end{align*}
\end{proposition}


\Vincent{
Note that there seem to be a canonical integer drawing of~$R$ described as follows.
For vertical segment~$v$ of~$R$, consider the path~$p$ passing through~$v$ with maximal slope.
The abscissa of~$v$ is then the number of rectangle on the left of~$p$ plus the number of \horizontalPattern{} patterns along~$p$ before~$v$ minus the number of \horizontalPattern{} patterns along~$p$ after~$v$.
The ordinate of an horizontal segment~$h$ of~$R$ is defined symmetrically.
}

\begin{comment}
\newpage
\noindent
\input{figures/rectangulations2.tikz}
\vspace{1cm}
\noindent
\input{figures/rectangulations3.tikz}
\vspace{1cm}
\noindent
\input{figures/rectangulations4.tikz}
\newpage
\noindent
\input{figures/rectangulations5.tikz}
\newpage
\noindent
\input{figures/rectangulations6.tikz}
\clearpage
\end{comment}

\end{document}
